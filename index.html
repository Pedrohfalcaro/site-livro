<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Estante de histórias</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          animation: { fade: 'fadeIn 0.4s ease-in-out' },
          keyframes: {
            fadeIn: {
              '0%': { opacity: 0, transform: 'scale(0.98)' },
              '100%': { opacity: 1, transform: 'scale(1)' }
            }
          }
        }
      }
    }
  </script>

  <style>
    .tag-btn.selected { box-shadow: 0 0 0 2px rgba(124, 58, 237, 0.7); transform: scale(1.05); }

    /* ====== Carrossel ====== */
    .no-scrollbar::-webkit-scrollbar { display: none; }
    .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }

    /* Snap para deslizar card-a-card */
    #obrasContainer, #contosContainer {
      gap: 2rem;
      scroll-snap-type: x mandatory;
      scroll-padding: 1rem;
      padding-bottom: .25rem;
    }
    #obrasContainer .obra, #contosContainer .obra {
      flex: 0 0 calc(33.333% - 1.333rem);
      scroll-snap-align: start;
    }
    @media (max-width: 1024px) {
      #obrasContainer .obra, #contosContainer .obra { flex: 0 0 calc(50% - 1rem); }
    }
    @media (max-width: 640px) {
      #obrasContainer .obra, #contosContainer .obra { flex: 0 0 90%; } /* dá “respiro” lateral no mobile */
    }

    .carousel-btn {
      position: absolute;
      top: 50%;
      transform: translateY(-50%);
      background: rgba(255,255,255,0.98);
      border-radius: 9999px;
      padding: 0.9rem 1rem;
      font-size: 1.4rem;
      font-weight: bold;
      color: #7e22ce;
      box-shadow: 0 4px 12px rgba(0,0,0,.25);
      transition: background .2s ease, transform .2s ease, color .2s ease, opacity .2s ease;
      z-index: 10;
    }
    .carousel-btn:hover { background: #fff; color: #9333ea; transform: translateY(-50%) scale(1.05); }
    .carousel-btn-left { left: -1rem; }
    .carousel-btn-right { right: -1rem; }
    /* No mobile, traz as setas pra dentro e reduz um pouco */
    @media (max-width: 640px) {
      .carousel-btn { opacity: .95; font-size: 1.2rem; padding: .7rem .85rem; }
      .carousel-btn-left { left: .25rem; }
      .carousel-btn-right { right: .25rem; }
    }

    /* ====== Tema escuro ====== */
    .theme-dot { width: 24px; height: 24px; border-radius: 50%; border: 2px solid #fff; cursor: pointer; }
    #temaClaro { background: linear-gradient(90deg, #ffffff 50%, #7e22ce 50%); }
    #temaEscuro { background: linear-gradient(90deg, #1f2937 50%, #a78bfa 50%); }

    body.dark-mode { background-color: #0b1220; color: #e5e7eb; }

    body.dark-mode nav.bg-purple-700 { background-color: #6d28d9 !important; }
    body.dark-mode .bg-gradient-to-br.from-purple-700.to-indigo-700 {
      background-image: linear-gradient(to bottom right, #6d28d9, #4338ca) !important;
    }

    body.dark-mode .bg-white,
    body.dark-mode .obra,
    body.dark-mode .card,
    body.dark-mode .tag-btn,
    body.dark-mode input,
    body.dark-mode textarea {
      background-color: #1f2937 !important;
      color: #e5e7eb !important;
      border-color: #374151 !important;
    }

    /* Contos — fundo claro/escuro */
    #contos .obra { background-color: #ffffff; color: #1f2937; }
    body.dark-mode #contos .obra { background-color: #1e1e1e !important; color: #e5e7eb !important; }

    #contos .obra h3 { color: #1f2937 !important; }
    #contos .obra p { color: #4b5563 !important; }
    body.dark-mode #contos .obra h3 { color: #e5e7eb !important; }
    body.dark-mode #contos .obra p  { color: #d1d5db !important; }

    #contos { background-color: #ffffff; }
    body.dark-mode #contos { background-color: #0b1220 !important; }

    body.dark-mode .text-gray-800 { color: #e5e7eb !important; }
    body.dark-mode .text-gray-700 { color: #d1d5db !important; }
    body.dark-mode .text-gray-600 { color: #9ca3af !important; }

    body.dark-mode .bg-purple-600 { background-color: #8b5cf6 !important; }
    body.dark-mode .hover\:bg-purple-700:hover { background-color: #7c3aed !important; }
    body.dark-mode .text-purple-700 { color: #c4b5fd !important; }

    body.dark-mode .border-gray-200 { border-color: #374151 !important; }
    body.dark-mode .bg-gray-100,
    body.dark-mode .bg-gray-50 {
      background-color: #0b1220 !important;
      color: #e5e7eb !important;
    }

    /* Menu link underline animado */
    .nav-link { position: relative; padding-bottom: 4px; transition: opacity .2s ease; }
    .nav-link:hover { opacity: .95; }
    .nav-link::after {
      content: "";
      position: absolute;
      left: 0; bottom: -6px;
      width: 0%; height: 3px; background: rgba(255,255,255,.9);
      border-radius: 9999px; transition: width .25s ease;
    }
    .nav-link:hover::after { width: 100%; }
    .theme-dot { box-shadow: 0 0 0 2px rgba(255,255,255,.35) inset; }
    .theme-dot:hover { box-shadow: 0 0 0 2px rgba(255,255,255,.75) inset; }
    body.dark-mode .nav-link::after { background: #e9d5ff; }
    body.dark-mode nav { box-shadow: 0 2px 12px rgba(0,0,0,.35); }
  </style>
</head>

<body class="bg-gray-100 text-gray-900 font-sans relative overflow-x-hidden min-h-screen">
  <!-- Alerta flutuante -->
  <div id="mensagemSucesso" class="hidden fixed top-20 right-6 z-50 bg-green-100 border border-green-400 text-green-800 px-6 py-3 rounded shadow-lg animate-fade">
    ✅ Livro adicionado à Sacola!
  </div>

  <!-- POPUP Sacola -->
  <div id="popupEstante" class="fixed top-0 right-0 w-full sm:w-96 h-full bg-white shadow-2xl p-6 z-50 transform translate-x-full transition-transform duration-300 overflow-y-auto">
    <div class="flex justify-between items-center mb-4">
      <h2 class="text-2xl font-bold text-purple-700">Sua Sacola</h2>
      <button onclick="toggleEstante()" class="text-gray-500 hover:text-red-600 text-2xl font-bold leading-none p-2">&times;</button>
    </div>
    <div id="listaEstante" class="space-y-4"></div>
    <div class="mt-6 border-t pt-4 text-right">
      <p class="text-xl font-bold mb-4">Total: <span id="totalValor">R$ 0,00</span></p>
      <a href="pagamento.html" class="inline-block bg-green-600 text-white px-6 py-2 rounded-full hover:bg-green-700 transition-all">Finalizar Compra</a>
    </div>
  </div>

  <!-- Overlay -->
  <div id="overlayEstante" onclick="toggleEstante()" class="hidden fixed inset-0 bg-black/30 z-40 cursor-pointer"></div>

  <!-- Barra de Navegação Topo (responsiva) -->
  <nav class="bg-purple-700 text-white py-4 sm:py-5 px-4 sm:px-6 shadow-md sticky top-0 z-50">
    <div class="max-w-7xl mx-auto flex items-center gap-4">
      <!-- Botões de tema -->
      <div class="flex items-center gap-2 shrink-0">
        <button id="temaClaro" class="theme-dot" title="Tema claro" aria-label="Tema claro"></button>
        <button id="temaEscuro" class="theme-dot" title="Tema escuro" aria-label="Tema escuro"></button>
      </div>

      <!-- Título -->
      <h1 class="text-xl sm:text-2xl md:text-3xl font-extrabold tracking-tight">
        Estante de Histórias
      </h1>

      <!-- Ações (desktop) -->
      <div class="ml-auto items-center gap-6 sm:gap-8 md:gap-10 text-sm sm:text-base md:text-lg font-medium hidden md:flex">
        <button onclick="scrollToSection('obrasProjetos')" class="nav-link">Obras & Projetos</button>
        <button onclick="scrollToSection('sobreAutor')" class="nav-link">Sobre o Autor</button>
        <button onclick="scrollToSection('linhaTempo')" class="nav-link">Linha do Tempo</button>
        <button onclick="document.getElementById('contos').scrollIntoView({ behavior: 'smooth' })"
          class="ml-2 px-4 py-2 bg-white/15 hover:bg-white/25 backdrop-blur-sm border border-white/20 rounded-full shadow-md transition">
          Contos
        </button>
        <button onclick="toggleEstante()"
          class="px-4 py-2 rounded-full bg-white/15 hover:bg-white/25 backdrop-blur-sm border border-white/20 transition">
          Sacola
        </button>
      </div>

      <!-- Botões (mobile) -->
      <div class="ml-auto flex md:hidden items-center gap-2">
        <button onclick="toggleEstante()" class="px-3 py-2 rounded-full bg-white/15 hover:bg-white/25 border border-white/20">Sacola</button>
        <button id="btnMenu" class="p-2 rounded-lg bg-white/15 hover:bg-white/25 border border-white/20" aria-label="Abrir menu">
          ☰
        </button>
      </div>
    </div>

    <!-- Menu colapsável (mobile) -->
    <div id="menuMobile" class="md:hidden hidden mt-3">
      <div class="flex flex-col gap-2 text-base">
        <button onclick="scrollToSection('obrasProjetos');toggleMenu()" class="text-left px-3 py-2 hover:bg-white/10 rounded-lg">Obras & Projetos</button>
        <button onclick="scrollToSection('sobreAutor');toggleMenu()" class="text-left px-3 py-2 hover:bg-white/10 rounded-lg">Sobre o Autor</button>
        <button onclick="scrollToSection('linhaTempo');toggleMenu()" class="text-left px-3 py-2 hover:bg-white/10 rounded-lg">Linha do Tempo</button>
        <button onclick="document.getElementById('contos').scrollIntoView({ behavior: 'smooth' });toggleMenu()"
                class="text-left px-3 py-2 hover:bg-white/10 rounded-lg">Contos</button>
      </div>
    </div>
  </nav>

  <!-- Hero -->
  <section class="bg-gradient-to-br from-purple-700 to-indigo-700 text-white py-8 sm:py-10 px-4 md:px-8">
    <div class="max-w-6xl mx-auto grid grid-cols-1 md:grid-cols-2 items-center gap-8">
      <div class="animate-fade text-center md:text-left order-2 md:order-1">
        <h2 class="text-2xl sm:text-3xl md:text-4xl font-bold mb-2">Pré-venda Exclusiva (Até 30/09/2025)</h2>
        <p class="text-sm sm:text-base md:text-lg mb-4">"A Lenda do Caos - Tríplice Caótica" já está disponível! Comprando na pré-venda você recebe um marca-páginas e um conto exclusivo dentro do universo do livro!</p>
        <button 
          onclick="adicionarLivro('A Lenda do Caos - Tríplice Caótica', 52.9, 'LdC1.png')" 
          class="bg-white text-purple-700 px-5 py-2 rounded-full font-semibold hover:bg-gray-100 transition-all shadow-md">
           Adicionar à Sacola
        </button>
      </div>
      <div class="flex justify-center md:justify-end order-1 md:order-2">
        <img src="LdC1.png" alt="Capa do Livro" class="w-40 sm:w-52 md:w-72 h-64 object-cover rounded-xl shadow-2xl transform hover:scale-105 transition-all duration-300" />
      </div>
    </div>
  </section>

  <!-- Obras -->
  <section id="obrasProjetos" class="max-w-6xl mx-auto py-12 sm:py-16 px-4">
    <h2 class="text-2xl sm:text-3xl font-extrabold text-center mb-6 text-purple-700">Obras & Projetos</h2>

    <!-- Filtros -->
    <div class="flex flex-col sm:flex-row sm:items-center justify-between gap-3 sm:gap-4 mb-8">
      <input 
        type="text" id="buscaObra" placeholder="🔍 Procurar título..."
        class="w-full sm:w-1/2 px-4 py-3 rounded-full border border-purple-300 shadow focus:outline-none focus:ring-2 focus:ring-purple-400 transition-all bg-white"
        oninput="filtrarObras()"
      />
      <div class="flex gap-2 flex-wrap justify-center sm:justify-start">
        <button onclick="filtrarTag('todos')" data-tag="todos" class="tag-btn bg-purple-100 text-purple-700 px-3 py-1.5 rounded-full text-sm font-semibold hover:bg-purple-200 transition-all">Todos</button>
        <button onclick="filtrarTag('Livro')" data-tag="Livro" class="tag-btn bg-green-100 text-green-700 px-3 py-1.5 rounded-full text-sm font-semibold hover:bg-green-200 transition-all">📖 Livro</button>
        <button onclick="filtrarTag('Áudio-série')" data-tag="Áudio-série" class="tag-btn bg-purple-100 text-purple-700 px-3 py-1.5 rounded-full text-sm font-semibold hover:bg-purple-200 transition-all">🎧 Áudio-série</button>
        <button onclick="filtrarTag('WebLivro')" data-tag="WebLivro" class="tag-btn bg-indigo-100 text-indigo-700 px-3 py-1.5 rounded-full text-sm font-semibold hover:bg-indigo-200 transition-all">🌐 WebLivro</button>
      </div>
    </div>

    <!-- Carrossel -->
    <div class="relative">
      <button id="prevObras" class="carousel-btn carousel-btn-left hidden sm:block" aria-label="Anterior">&lt;</button>

      <div id="obrasContainer" class="flex overflow-x-auto no-scrollbar scroll-smooth">
        <!-- Livro -->
        <div class="obra" data-tags="Livro">
          <div class="bg-white rounded-3xl shadow-lg flex flex-col p-5 h-full hover:shadow-xl transition-all group relative">
            <div class="absolute top-3 left-3 z-10 bg-green-100 text-green-700 px-3 py-1 text-xs font-bold rounded-full shadow-sm">📖 Livro</div>
            <img src="LdC1.png" class="w-full h-64 object-cover rounded-2xl mb-4 transform group-hover:scale-105 transition-all" alt="A Lenda do Caos capa"/>
            <h3 class="text-lg sm:text-xl font-bold text-center mb-1">A Lenda do Caos - Tríplice Caótica + Marca-páginas + Conto exclusivo</h3>
            <p class="text-base sm:text-lg mt-2 text-center">
              <del class="text-red-500 text-base mr-2">R$ 57,90</del>
              <strong class="text-green-600 text-xl font-bold">R$ 52,90</strong>
            </p>
            <div class="mt-auto pt-4">
              <button 
                onclick="abrirDetalhes({
                  nome: 'A Lenda do Caos - Tríplice Caótica + Marca-páginas + Conto exclusivo',
                  descricao: 'E se cada história que já foi contada existisse de verdade, em um universo próprio, moldado pela mente de quem a criou? Arthur, um garoto comum de 14 anos, sempre acreditou que histórias eram apenas... histórias. Mas tudo muda quando uma simples narrativa contada pelo seu pai se transforma em algo maior — muito maior. Ele começa a ver coisas que ninguém mais vê. Ouvir vozes que ninguém mais ouve. Sentir um chamado vindo de um lugar que ele nem sabia existir. O que Arthur não sabe é que sua mente se conectou a uma porta — uma ligação entre mundos. Uma passagem entre a realidade que vivemos e outra, nascida do caos primordial: a realidade da história que escutou. Arthur se vê no centro de uma guerra entre mundos, onde criação e destruição são apenas duas faces da mesma força: o Caos.',
                  preco: 52.9,
                  imagem: 'LdC1.png',
                  youtube: null,
                  tipo: 'livro'
                })"
                class="w-full bg-purple-600 text-white py-2 rounded-full hover:bg-purple-700 transition mt-4">
                Ver Detalhes
              </button>
            </div>
          </div>
        </div>

        <!-- Áudio-série -->
        <div class="obra" data-tags="Áudio-série">
          <div class="bg-white rounded-3xl shadow-lg flex flex-col p-5 h-full hover:shadow-xl transition-all group relative">
            <div class="absolute top-3 left-3 z-10 bg-purple-100 text-purple-700 px-3 py-1 text-xs font-bold rounded-full shadow-sm">🎧 Áudio-série</div>
            <img src="AdC1.jpg" class="w-full h-64 object-cover rounded-2xl mb-4 transform group-hover:scale-105 transition-all" alt="Além dos Céus T1 capa"/>
            <h3 class="text-lg sm:text-xl font-bold text-center mb-1">Além dos Céus – T1: Desbravadores</h3>
            <p class="text-gray-600 text-sm mb-3 text-center">Uma jornada espacial e sentimental através do universo.</p>
            <div class="mt-auto pt-4">
              <button 
                onclick="abrirDetalhes({
                  nome: 'Além dos Céus – Temporada 1: Desbravadores',
                  descricao: 'Além dos Céus é uma áudio série focada em aventuras e viagens espaciais. Leonardo é o protagonista desta história, onde sua tarefa é liderar uma equipe em uma missão rumo a um sistema solar longínquo. Ele irá lidar, com sentimentos, conflitos internos e decisões difíceis a tomar, além de muita ação e determinação. Como será a aventura desta tripulação? Isso você só descobrirá em Além dos Céus',
                  imagem: 'AdC1.jpg',
                  youtube: 'https://youtube.com/playlist?list=PLVQe8695upyjlnarF121CIlis7cCW6-n1&si=Ly59Vjxq5-M0a6tf',
                  tipo: 'audio'
                })"
                class="w-full bg-purple-600 text-white py-2 rounded-full hover:bg-purple-700 transition mt-4">
                Ver Detalhes
              </button>
            </div>
          </div>
        </div>

        <!-- WebLivro -->
        <div class="obra" data-tags="WebLivro">
          <div class="bg-white rounded-3xl shadow-lg flex flex-col p-5 h-full hover:shadow-xl transition-all group relative">
            <div class="absolute top-3 left-3 z-10 bg-indigo-100 text-indigo-700 px-3 py-1 text-xs font-bold rounded-full shadow-sm">🌐 WebLivro</div>
            <img src="IdW.jpg" class="w-full h-64 object-cover rounded-2xl mb-4 transform group-hover:scale-105 transition-all" alt="O Incidente de Willowbrook capa"/>
            <h3 class="text-lg sm:text-xl font-bold text-center mb-1">O incidente de Willowbrook</h3>
            <p class="text-base mt-2 text-center text-gray-800"><strong class="text-indigo-600 text-xl font-bold">R$ 7,50</strong></p>
            <div class="mt-auto pt-4">
              <button 
                onclick="abrirDetalhes({
                  nome: 'O Incidente de Willowbrook',
                  descricao: 'Em um Reino Unido envolto em mistérios e segredos, Emily Holwes, uma investigadora surda, recebe uma carta de um antigo amigo propondo um trabalho intrigante: investigar o misterioso vilarejo de Willowbrook, onde todos os habitantes morreram repentinamente. Determinada a desvendar o que aconteceu, Emily embarca em uma jornada que a leva por caminhos obscuros e inesperados...',
                  preco: 7.5,
                  imagem: 'IdW.jpg',
                  youtube: null,
                  tipo: 'weblivro',
                  hotmartLink: 'https://hotmart.com/pt-br/marketplace/produtos/o-incidente-de-willowbrook/I101263325N'
                })"
                class="w-full bg-purple-600 text-white py-2 rounded-full hover:bg-purple-700 transition mt-4">
                Ver Detalhes
              </button>
            </div>
          </div>
        </div>

        <!-- WebLivro 2 -->
        <div class="obra" data-tags="WebLivro">
          <div class="bg-white rounded-3xl shadow-lg flex flex-col p-5 h-full hover:shadow-xl transition-all group relative">
            <div class="absolute top-3 left-3 z-10 bg-indigo-100 text-indigo-700 px-3 py-1 text-xs font-bold rounded-full shadow-sm">🌐 WebLivro</div>
            <img src="LdC1.png" class="w-full aspect-[2/3] object-cover rounded-2xl mb-4 transform group-hover:scale-105 transition-all" alt="A Lenda do Caos (Web) capa"/>
            <h3 class="text-lg sm:text-xl font-bold text-center mb-1">A Lenda do Caos: Tríplice Caótica (Versão Web)</h3>
            <p class="text-base sm:text-lg mt-2 text-center">
              <del class="text-red-500 text-base mr-2">R$ 25,90</del>
              <strong class="text-green-600 text-xl font-bold">R$ 19,90</strong>
            </p>
            <div class="mt-auto pt-4">
              <button 
                onclick="abrirDetalhes({
                  nome: 'A Lenda do Caos: Tríplice Caótica (Versão Web)',
                  descricao: 'E se cada história que já foi contada existisse de verdade, em um universo próprio, moldado pela mente de quem a criou?...',
                  preco: 24.9,
                  imagem: 'LdC1.png',
                  youtube: null,
                  tipo: 'weblivro',
                  hotmartLink: 'https://pay.hotmart.com/SEU_HOTLINK_LDC_WEB'
                })"
                class="w-full bg-purple-600 text-white py-2 rounded-full hover:bg-purple-700 transition mt-4">
                Ver Detalhes
              </button>
            </div>
          </div>
        </div>
      </div>

      <button id="nextObras" class="carousel-btn carousel-btn-right hidden sm:block" aria-label="Próximo">&gt;</button>
    </div>
  </section>

  <!-- Sobre o Autor -->
  <section id="sobreAutor" class="bg-gradient-to-br from-indigo-600 to-purple-800 text-white py-14 sm:py-16 px-4 sm:px-6">
    <div class="max-w-4xl mx-auto text-center">
      <h2 class="text-2xl sm:text-3xl font-extrabold mb-4">Sobre o Autor</h2>
      <p class="text-base sm:text-lg leading-relaxed">Pedro Henrique é um autor brasileiro apaixonado por mundos fantásticos...</p>
      <p class="mt-4 text-sm sm:text-md opacity-90">Além da literatura, Pedro também atua como roteirista, e contador de histórias...</p>
    </div>
  </section>

  <!-- Linha do Tempo -->
  <section id="linhaTempo" class="bg-white py-14 sm:py-16 px-4 sm:px-6">
    <div class="max-w-4xl mx-auto">
      <h2 class="text-2xl sm:text-3xl font-extrabold text-center text-purple-700 mb-8 sm:mb-10">Linha do Tempo do Universo</h2>
      <div class="relative border-l-4 border-purple-600 pl-6 space-y-8 sm:space-y-10">
        <div class="relative">
          <div class="absolute -left-4 top-1.5 w-3 h-3 bg-purple-600 rounded-full"></div>
          <h3 class="text-lg sm:text-xl font-bold text-purple-700">02 de novembro de 2024</h3>
          <p class="text-gray-700 text-sm sm:text-base">Estreia da áudio-série <strong>Além dos Céus – T1: Desbravadores</strong>.</p>
        </div>
        <div class="relative">
          <div class="absolute -left-4 top-1.5 w-3 h-3 bg-indigo-600 rounded-full"></div>
          <h3 class="text-lg sm:text-xl font-bold text-indigo-700">Setembro de 2025 (previsão)</h3>
          <p class="text-gray-700 text-sm sm:text-base">Lançamento do livro <strong>A Lenda do Caos – Tríplice Caótica</strong>.</p>
        </div>
        <div class="relative">
          <div class="absolute -left-4 top-1.5 w-3 h-3 bg-gray-400 rounded-full animate-pulse"></div>
          <h3 class="text-lg sm:text-xl font-bold text-gray-600">Março de 2026 <span class="italic">(?)</span></h3>
          <p class="text-gray-600 italic text-sm sm:text-base">Algo novo está vindo...</p>
        </div>
      </div>
    </div>
  </section>

  <!-- ================= Seção Contos ================= -->
  <section id="contos" class="py-10">
    <div class="max-w-7xl mx-auto px-4">
      <h2 class="text-2xl sm:text-3xl font-bold text-purple-700 dark:text-purple-300 mb-6">Contos</h2>

      <div class="relative">
        <button id="prevContos" class="carousel-btn carousel-btn-left hidden sm:block" aria-label="Anterior">&lt;</button>

        <div id="contosContainer" class="flex overflow-x-auto no-scrollbar scroll-smooth">
          <!-- Card exemplo -->
          <div class="obra bg-white dark:bg-gray-800 rounded-3xl shadow-md overflow-hidden">
            <img src="ContoMUcapa.png" alt="Capa conto" class="w-full aspect-[16/9] object-cover">
            <div class="p-4">
              <h3 class="font-bold text-base sm:text-lg text-gray-800 dark:text-white">Meu Universo</h3>
              <p class="text-gray-600 dark:text-gray-300 text-sm mt-1">Um conto ambientado entre estrelas, silêncio e decisões que mudam rotas.</p>
              <a href="ContosMeuUniverso.html" 
                 class="mt-3 block w-full bg-purple-600 hover:bg-purple-700 text-white py-2 px-4 rounded-lg text-center transition">
                 Ler conto
              </a>
            </div>
          </div>
          <!-- /Card exemplo -->
        </div>

        <button id="nextContos" class="carousel-btn carousel-btn-right hidden sm:block" aria-label="Próximo">&gt;</button>
      </div>
    </div>
  </section>

  <!-- POPUP DE DETALHES -->
  <div id="popupDetalhes" class="fixed inset-0 bg-black/50 z-50 hidden flex items-center justify-center p-4">
    <div class="bg-white rounded-3xl shadow-2xl w-full max-w-5xl h-[90vh] flex flex-col-reverse sm:flex-row overflow-hidden animate-fade relative border-t-4 border-purple-700">
      <button onclick="fecharDetalhes()" class="absolute top-4 right-4 text-gray-400 hover:text-red-500 text-3xl font-bold z-10 transition" aria-label="Fechar">&times;</button>
      <div class="flex-1 p-6 sm:p-10 overflow-y-auto flex flex-col">
        <h2 id="detalheTitulo" class="text-2xl sm:text-3xl font-bold text-purple-700 mb-4"></h2>
        <p id="detalhePreco" class="text-xl font-bold text-green-700 mb-4 hidden"></p>
        <div id="detalheDescricao" class="text-gray-800 leading-relaxed whitespace-pre-line max-h-[50vh] overflow-y-auto mb-6 text-sm sm:text-base"></div>
        <div id="botoesDetalhes" class="mt-auto flex flex-col sm:flex-row gap-3 sm:gap-4 justify-center pt-6 border-t border-gray-200"></div>
      </div>
      <div class="w-full sm:w-1/3 bg-gray-100 p-4 sm:p-6 flex items-center justify-center border-t sm:border-t-0 sm:border-l border-gray-200">
        <img id="detalheImagem" src="" alt="Capa da Obra" class="w-40 sm:w-full h-auto max-h-52 sm:max-h-[80vh] object-contain rounded-2xl shadow-lg"/>
      </div>
    </div>
  </div>

  <!-- Scripts base -->
  <script>
    /* ===== Tema (unificado) ===== */
    (function () {
      const BODY = document.body;
      const KEY = 'theme';
      const btnClaro = document.getElementById('temaClaro');
      const btnEscuro = document.getElementById('temaEscuro');

      function apply(theme) {
        if (theme === 'dark') {
          BODY.classList.add('dark-mode');
          btnEscuro?.classList.add('ring-2','ring-white');
          btnClaro?.classList.remove('ring-2','ring-white');
        } else {
          BODY.classList.remove('dark-mode');
          btnClaro?.classList.add('ring-2','ring-white');
          btnEscuro?.classList.remove('ring-2','ring-white');
        }
      }

      // Estado inicial
      apply(localStorage.getItem(KEY) || 'light');

      // Listeners
      btnClaro?.addEventListener('click', () => { localStorage.setItem(KEY, 'light'); apply('light'); });
      btnEscuro?.addEventListener('click', () => { localStorage.setItem(KEY, 'dark');  apply('dark');  });
    })();

    /* ===== Menu mobile ===== */
    const btnMenu = document.getElementById('btnMenu');
    const menuMobile = document.getElementById('menuMobile');
    function toggleMenu(){ menuMobile.classList.toggle('hidden'); }
    btnMenu?.addEventListener('click', toggleMenu);

    /* ===== Sacola ===== */
    function adicionarLivro(nome, preco, imagem) {
      const estante = JSON.parse(localStorage.getItem("estante")) || [];
      const index = estante.findIndex(l => l.nome === nome);
      if (index !== -1) estante[index].quantidade++;
      else estante.push({ nome, preco, imagem, quantidade: 1 });
      localStorage.setItem("estante", JSON.stringify(estante));
      mostrarMensagem();
      atualizarPopupEstante();
    }

    function mostrarMensagem() {
      const msg = document.getElementById("mensagemSucesso");
      msg.classList.remove("hidden");
      setTimeout(() => msg.classList.add("hidden"), 2000);
    }

    function removerLivro(index) {
      const estante = JSON.parse(localStorage.getItem("estante")) || [];
      estante.splice(index, 1);
      localStorage.setItem("estante", JSON.stringify(estante));
      atualizarPopupEstante();
    }

    function atualizarPopupEstante() {
      const lista = document.getElementById("listaEstante");
      const totalSpan = document.getElementById("totalValor");
      const estante = JSON.parse(localStorage.getItem("estante")) || [];
      lista.innerHTML = "";
      let total = 0;

      if (estante.length === 0) {
        lista.innerHTML = `<div class="text-center text-gray-500">
            <div class="text-5xl mb-2">📭</div>
            <p class="text-lg">Sua sacola está vazia... por enquanto!</p>
          </div>`;
        totalSpan.textContent = "R$ 0,00";
        return;
      }

      estante.forEach((livro, index) => {
        total += livro.preco * livro.quantidade;
        lista.innerHTML += `
          <div class="flex items-center gap-4 border-b pb-4">
            <img src="${livro.imagem}" class="w-16 h-24 object-cover rounded shadow" alt="${livro.nome}"/>
            <div class="flex-1">
              <h3 class="font-semibold">${livro.nome}</h3>
              <p class="text-sm text-gray-600">R$ ${livro.preco.toFixed(2)} x ${livro.quantidade}</p>
              <p class="text-sm font-bold">Total: R$ ${(livro.preco * livro.quantidade).toFixed(2)}</p>
            </div>
            <button onclick="removerLivro(${index})" class="text-red-500 hover:text-red-700 font-bold text-xl rounded-full px-2 py-0.5 transition-all" aria-label="Remover">&times;</button>
          </div>
        `;
      });

      totalSpan.textContent = "R$ " + total.toFixed(2);
    }

    function toggleEstante() {
      const popup = document.getElementById("popupEstante");
      const overlay = document.getElementById("overlayEstante");
      const isOpen = !popup.classList.contains("translate-x-full");

      if (isOpen) {
        popup.classList.add("translate-x-full");
        overlay.classList.add("hidden");
      } else {
        popup.classList.remove("translate-x-full");
        overlay.classList.remove("hidden");
        atualizarPopupEstante();
      }
    }

    document.addEventListener("DOMContentLoaded", atualizarPopupEstante);

    /* ===== Filtros ===== */
    function filtrarObras() {
      const textoBusca = document.getElementById("buscaObra").value.toLowerCase();
      const obras = document.querySelectorAll("#obrasContainer .obra");
      const tagAtiva = document.querySelector(".tag-btn.selected")?.dataset?.tag || "todos";

      obras.forEach(obra => {
        const titulo = obra.querySelector("h3")?.innerText?.toLowerCase() || "";
        const tags = obra.getAttribute("data-tags");
        const correspondeTexto = titulo.includes(textoBusca);
        const correspondeTag = tagAtiva === "todos" || tags === tagAtiva;
        obra.style.display = (correspondeTexto && correspondeTag) ? "" : "none";
      });
    }

    function filtrarTag(tag) {
      const botoes = document.querySelectorAll(".tag-btn");
      botoes.forEach(btn => btn.classList.remove("selected"));
      const botaoSelecionado = [...botoes].find(b => b.dataset.tag === tag);
      if (botaoSelecionado) botaoSelecionado.classList.add("selected");
      filtrarObras();
    }

    /* ===== Scroll suave ===== */
    function scrollToSection(id) {
      const section = document.getElementById(id);
      if (section) section.scrollIntoView({ behavior: 'smooth', block: 'start' });
    }

    /* ===== Popup Detalhes ===== */
    function abrirDetalhes(detalhes) {
      const { nome, descricao, preco, imagem, youtube, tipo, hotmartLink } = detalhes;

      document.getElementById("detalheTitulo").textContent = nome;
      document.getElementById("detalheDescricao").textContent = descricao;
      const precoEl = document.getElementById("detalhePreco");
      const imagemEl = document.getElementById("detalheImagem");
      const botoesEl = document.getElementById("botoesDetalhes");

      if (preco !== null && preco !== undefined && tipo === "livro") {
        precoEl.textContent = `R$ ${preco.toFixed(2)}`;
        precoEl.classList.remove("hidden");
      } else {
        precoEl.classList.add("hidden");
        precoEl.textContent = "";
      }

      imagemEl.src = imagem;
      imagemEl.alt = `Capa de ${nome}`;

      botoesEl.innerHTML = "";

      if (tipo === "livro" && preco) {
        botoesEl.innerHTML += `
          <button onclick="adicionarLivro('${nome.replace(/'/g,"\\'")}', ${preco}, '${imagem}')" 
            class="bg-purple-600 text-white px-6 py-2 rounded-full hover:bg-purple-700 transition-all">
             Adicionar à Sacola
          </button>`;
      }

      if (tipo === "weblivro" && hotmartLink) {
        botoesEl.innerHTML += `
          <a href="${hotmartLink}" target="_blank" rel="noopener"
            class="bg-indigo-600 text-white px-6 py-2 rounded-full hover:bg-indigo-700 transition-all text-center">
             Acessar Hotmart
          </a>`;
      }

      if (youtube) {
        botoesEl.innerHTML += `
          <a href="${youtube}" target="_blank" rel="noopener"
            class="bg-red-600 text-white px-6 py-2 rounded-full hover:bg-red-700 transition-all text-center">
             Assistir no YouTube
          </a>`;
      }

      document.getElementById("popupDetalhes").classList.remove("hidden");
      document.body.classList.add("overflow-hidden");
    }
    function fecharDetalhes() {
      document.getElementById("popupDetalhes").classList.add("hidden");
      document.body.classList.remove("overflow-hidden");
    }

    /* ===== Carrosséis (viewport-based) ===== */
    (function () {
      const makeCarousel = (areaId, prevId, nextId) => {
        const area = document.getElementById(areaId);
        const prev = document.getElementById(prevId);
        const next = document.getElementById(nextId);
        if (!area || !prev || !next) return;

        function scrollByViewport(dir) {
          const amount = area.clientWidth;
          area.scrollBy({ left: dir * amount, behavior: 'smooth' });
        }
        prev.addEventListener('click', () => scrollByViewport(-1));
        next.addEventListener('click', () => scrollByViewport(1));
      };
      makeCarousel('obrasContainer', 'prevObras', 'nextObras');
      makeCarousel('contosContainer', 'prevContos', 'nextContos');
    })();

    /* ===== Acessibilidade: reduzir animações se preferido ===== */
    (() => {
      const mq = window.matchMedia('(prefers-reduced-motion: reduce)');
      if (mq.matches) {
        document.querySelectorAll('[class*="animate-"]').forEach(el => el.classList.remove('animate-fade'));
      }
    })();
  </script>
</body>
</html>
